This is a naive implemenation to get started.
Currently not workwing.

Currently working on python code doing the same. That should be easier to verify and we can compare subreults against that.