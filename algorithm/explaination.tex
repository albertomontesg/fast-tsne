\documentclass{article}

\usepackage[]{algorithm2e}
\usepackage{amsmath,amssymb}

\begin{document}

\begin{algorithm}[H]
 \KwData{high dimensional data $\mathbf{X} = \{\mathbf{X}_1, \dots, \mathbf{X}_N \} \subseteq \mathbb{R}^D$, Target Perplexity $P$, Number of iterations $T$}
 \KwResult{low dimensional data $\mathbf{Y} = \{\mathbf{Y}_1, \dots, \mathbf{Y}_N \} \subseteq \mathbb{R}^d$ such that $d \ll D$ (usually d = 2 or 3)}
	compute squared eucledian distances $d_{ij} = \| \mathbf{X}_i - \mathbf{X}_j \|^2$ \;
	\For{$i = 0 .. N$}{
		initialize $\sigma_i$\;
		\Repeat{$\text{per}_i = P$}{
			$\forall j = 0..N \quad p_{j|i} = \frac{ \exp(- d_{ij} / 2 \sigma^2_i ) }{ \sum_{k \neq i } \exp(- d_{ik} / 2 \sigma^2_i )}$\;
			$\text{per}_i = 2^{\sum_j p_{j|i} \log_2 p_{j|i}  }$\;
		}
	}
	symmetrize $p_{ij} = \frac{p_{j|i} + p_{i|j}}{2N}$\;
	sample inital $\mathbf{Y}$ from gaussian distribution\;
	\For{$t = 0 .. T$}{
		compute $q_{ij} = \frac{ (1 + \| y_i - y_j \|^2)^{-1} }{ \sum_{k \neq l} (1 + \| y_k - y_l \|^2)^{-1} }$\;
		compute $\frac{\partial C}{\partial y_i} = 4 \sum_j (p_{ij} - q_{ij}) (y_i - y_j) (1 + \| y_i - y_j \|^2)^{-1}$\;
		update $\mathbf{Y}^{(t)} = \mathbf{Y}^{(t-1)} + \eta \frac{\partial C}{\partial mathbf{Y}} + \alpha(t) (\mathbf{Y}^{(t-1)} - \mathbf{Y}^{(t-2)}) $ \;
	}

 \caption{t-SNE Algorithm}
\end{algorithm}


\end{document}